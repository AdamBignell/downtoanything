

<iframe src="<%= @submission.embed %>" width="100%" height="600" frameborder="0" allowfullscreen webkitallowfullscreen mozallowfullscreen scrolling="no"></iframe>


<div class="card-deck-wrapper mt-2">
  <div class="card-deck">
      <div class="card" data-url="<%= challenge_submission_path(@challenge, @submission)%>">
          <div class="card-block">
            <h5 class="card-title">Submission to: <small class="h6"><p class="floatright"><%= link_to 'Edit', edit_challenge_submission_path(@challenge.id, @submission.id) %></p></small></h5>
            <h3 class="card-title"><%= Challenge.find(@submission.challenge_id).name %> Challenge </h3>
            <p class="card-text">By: <%= @submission.user_interactions.where(:interaction => "created").first.user.username %></p>
            <p class="card-text"><a href="<%= @submission.url %>"> <%=@submission.url %></a></p>
            <h3 class="card-text">Score: <%= @submission.score %></h3>
            <p class="card-text">
              <% if !@interaction || @interaction.interaction != "created" %>
                <% if !@interaction %>
                  <%= link_to("+1", {:action => 'upvote', :id => @submission.id, :st => 'none', :user => @user.id, :authenticity_token => form_authenticity_token()}, remote: true, method: :post) %> /
                  <%= link_to("-1", {:action => 'downvote', :id => @submission.id, :st => 'none', :user => @user.id, :authenticity_token => form_authenticity_token()}, remote: true, method: :post) %>
                <% else %>
                  <% case @interaction.interaction %>
                  <% when "neutral" %>
                    <%= link_to("+1", {:action => 'upvote', :id => @submission.id, :st => 'neither', :user => @user.id, :authenticity_token => form_authenticity_token()}, remote: true, method: :post) %> /
                    <%= link_to("-1", {:action => 'downvote', :id => @submission.id, :st => 'neither', :user => @user.id, :authenticity_token => form_authenticity_token()}, remote: true, method: :post) %>
                  <% when "liked" %>
                    <%= link_to("cancel", {:action => 'upvote', :id => @submission.id, :st => 'like', :user => @user.id, :authenticity_token => form_authenticity_token()}, remote: true, method: :post) %> /
                    <%= link_to("-1", {:action => 'downvote', :id => @submission.id, :st => 'like', :user => @user.id, :authenticity_token => form_authenticity_token()}, remote: true, method: :post) %>
                  <% else %>
                    <%= link_to("+1", {:action => 'upvote', :id => @submission.id, :st => 'dislike', :user => @user.id, :authenticity_token => form_authenticity_token()}, remote: true, method: :post) %> /
                    <%= link_to("-cancel", {:action => 'downvote', :id => @submission.id, :st => 'dislike', :user => @user.id, :authenticity_token => form_authenticity_token()}, remote: true, method: :post) %>
                  <% end %>
                <% end %>
              <% end %>
            </p>
            <p class="card-text"><small class="text-muted"><!-- TODO: submission uploaded --></small></p>
          </div>
      </div>
  </div>
      <h4> Comments </h4>
      <% @comments.each do |comment|  %>
      <hr>
      <p> <strong> <%= @users.find(comment.user_id).username %> | <%= comment.created_at %> </strong> </p>
      <p> <%= comment.body %> </p>
      <% end %>
</div>

<h6> Add a comment!: </h6>
  <%= render "comments/form" %>

<%= link_to 'Edit', edit_submission_path(@submission) %> |
<%= link_to 'Back', submissions_path %>
